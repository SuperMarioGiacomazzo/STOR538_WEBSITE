library(tidyverse)
library(readxl)
#Read in Actual Results
setwd("D:/Mario Documents/UNC/STOR 538/Not for Github/FA2020_PLAYOFF2")
Actual=read.csv("Actual.csv")
Actual$Spread=Actual$Home.Score-Actual$Visitor.Score
Actual$Total=Actual$Home.Score+Actual$Visitor.Score
Actual$Result=ifelse(Actual$Spread>0,1,0)
#Read in Predictions from Groups
setwd("D:/Mario Documents/UNC/STOR 538/Not for Github/FA2020_PLAYOFF2/Predictions")
group1=read.csv("Group_1.csv")
group2=read.csv("Group_2.csv")
group3=read_xlsx("Group_3.xlsx")
group4=read.csv("Group_4.csv")
group5=read.csv("Group_5.csv")
group6=read.csv("Group_6.csv")
group7=read.csv("Group_7.csv")
group8=read.csv("Group_8.csv")
group9=read.csv("Group_9.csv")
group10=read.csv("Group_10.csv")
group11=read.csv("Group_11.csv")
group12=read_xlsx("Group_12.xlsx")
group13=read_xlsx("Group_13.xlsx")
group14=read.csv("Group_14.csv")
#Modify Tables for Usage
Spread=tibble(Date=Actual$Date,Home=Actual$Home.Team,Away=Actual$Away.Team,Actual=Actual$Spread,
group1=group1$Spread,group2=group2$Spread,
group3=group3$Spread,group4=group4$Spread,
group5=group5$Spread,group6=group6$Spread,
group7=group7$Spread,group8=group8$Spread,
group9=group9$Spread,group10=group10$Spread,
group11=group11$Spread,group12=group12$Spread,
group13=group13$Spread,group14=group14$Spread)
Total=tibble(Date=Actual$Date,Home=Actual$Home.Team,Away=Actual$Away.Team,Actual=Actual$Total,
group1=group1$Total,group2=group2$Total,
group3=group3$Total,group4=group4$Total,
group5=group5$Total,group6=group6$Total,
group7=group7$Total,group8=group8$Total,
group9=group9$Total,group10=group10$Total,
group11=group11$Total,group12=group12$Total,
group13=group13$Total,group14=group14$Total)
Result=tibble(Date=Actual$Date,Home=Actual$Home.Team,Away=Actual$Away.Team,Actual=Actual$Result,
group1=group1$Result,group2=group2$Result,
group3=group3$Result,group4=group4$Result,
group5=group5$Result,group6=group6$Result,
group7=group7$Result,group8=group8$Result,
group9=group9$Result,group10=group10$Result,
group11=group11$Result,group12=group12$Result,
group13=group13$Result,group14=group14$Result)
Spread$group6=as.numeric(Spread$group6)
Spread$group13=as.numeric(Spread$group13)
#Functions for Evaluating Prediction Error
rmse.func=function(actual,predict){
return(sqrt(mean((actual-predict)^2,na.rm=T)))
}
mae.func=function(actual,predict){
return(mean(abs(actual-predict),na.rm=T))
}
acc.func=function(actual,predict){
return(mean(actual==predict,na.rm=T))
}
#Usage of Error Functions for Week 1
spread.final=apply(Spread[,c(5:18)],2,rmse.func,actual=Spread$Actual)
total.final=apply(Total[,5:18],2,mae.func,actual=Total$Actual)
result.final=apply(Result[,5:18],2,acc.func,actual=Result$Actual)
rmse.func(actual=Spread$Actual,predict=Spread$group1)
spread.order=rank(as.numeric(spread.final))
total.order=rank(as.numeric(total.final))
result.order=rank(-as.numeric(result.final),ties.method="min")
setwd("D:/Mario Documents/UNC/STOR 538/Not for Github/FA2020_PLAYOFF2")
write.csv(Spread,"ClassSpread.csv")
write.csv(Total,"ClassTotal.csv")
write.csv(Result,"ClassResult.csv")
setwd("D:/Mario Documents/UNC/STOR 538/STOR538_WEBSITE/Playoffs/Round 2")
write.csv(Spread,"PredictSpread.csv",row.names=F)
write.csv(Total,"PredictTotal.csv",row.names=F)
write.csv(Result,"PredictResult.csv",row.names=F)
spread.order
spread.final
total.final
total.order
total.order=rank(as.numeric(total.final))
total.order
total.final=apply(Total[,5:18],2,mae.func,actual=Total$Actual)
total.final
result.final
result.order
#install.packages("nflfastR")
library(nflfastR)
library(tidyverse)
#Play-by-Play Data in R
data2010 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2010.rds'))
data2011 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2011.rds'))
data2012 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2012.rds'))
data2013 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2013.rds'))
data2014 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2014.rds'))
data2015 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2015.rds'))
data2016 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2016.rds'))
data2017 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2017.rds'))
data2018 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2018.rds'))
data2019 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2019.rds'))
data2020 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2020.rds'))
data2021 <- readRDS(url('https://raw.githubusercontent.com/guga31bb/nflfastR-data/master/data/play_by_play_2021.rds'))
View(data2010)
GAME2010=data2010 %>%
group_by(game_id,posteam,posteam_type) %>%
summarize(Total_Yds=sum(yards_gained,na.rm=T),
TD_Pass=sum(pass_touchdown,na.rm=T),
TD_Rush=sum(rush_touchdown,na.rm=T),
FGA=sum(field_goal_attempt,na.rm=T),
FGM=sum(field_goal_result=="made",na.rm=T),
EPA=sum(extra_point_attempt,na.rm=T),
EPM=sum(extra_point_result=="good",na.rm=T),
TPCA=sum(two_point_attempt,na.rm=T),
TPCM=sum(two_point_conv_result=="success",na.rm=T),
SAFETY=sum(safety,na.rm=T),
RUSH_yds=sum(rush_attempt*yards_gained,na.rm=T),
PASS_yds=sum(pass_attempt*yards_gained,na.rm=T),
RA=sum(rush_attempt,na.rm=T),
PA=sum(pass_attempt,na.rm=T)) %>%
mutate(posteam_type=ifelse(posteam_type=="away","Away","Home")) %>%
filter(posteam!="") %>%
ungroup() %>%
mutate(Points=6*TD_Pass+6*TD_Rush+3*FGM+1*EPM+2*TPCM+2*SAFETY,
P_to_R=RA/PA) %>%
separate(game_id,into=c("YEAR","WEEK","AWAYCITY","HOMECITY"),sep="_") %>%
mutate(posteam=ifelse(posteam=="LA","LAR",posteam)) %>%
select(YEAR,WEEK,AWAYCITY,HOMECITY,everything())
140*21.99^2
sqrt(67698.41)
12/13
13*12
read_csv(url("https://raw.githubusercontent.com/mattymo18/STOR-538-P2-2021-Spring/master/Source_Data/game_results.csv"))
results = read_csv(url("https://raw.githubusercontent.com/mattymo18/STOR-538-P2-2021-Spring/master/Source_Data/game_results.csv"))
View(results)
