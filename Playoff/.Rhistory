library(rvest)
library(forcats)
people = c("Alex","Barry","Christina","Darko","Elaine","Frankie","Gyro","Hannah")
set.seed(213)
participant = tibble(name=people,
sex=factor(c("F","M","F","M","F","M","M","F")),
race = c("White","Black","Asian","White","Black","Asian","White","Black"),
age=sample(c(18:21),8,replace=T))
participant
set.seed(313)
education = tibble(name = people[c(2,7,8,3,1,4)],
origin = factor(c("North Carolina","North Carolina","Nigeria","China","California","North Carolina")),
edu = sample(c("UNC","NCSU","DUKE"),size=6,replace=T),
GPA= round(runif(6,2.9,4.0),2)
)
education
set.seed(911)
results = tibble(subject=people[c(1,1,2,2,3,3,4,4,5,5,6,6,7,7)],
time=rep(c("Before","After"),length=14),
)
before.wt = rnorm(7,mean=160,sd=30)
temp.full=right_join(full_join(participant,education),results, join_by(name==subject))
after.wt = before.wt - 1.25*temp.full$GPA[seq(1,14,2)]- 2*ifelse(temp.full$sex[seq(1,14,2)]=="M",0,1) + rnorm(7,mean=0,sd=1)
results$weight = NA
results$weight[seq(1,14,2)]=before.wt
results$weight[seq(2,14,2)]=after.wt
results
table1 = mutate(spread(data=na.omit(results),key=time,value=weight),Change=After-Before)
table2 = select(rename(education,subject=name),subject,GPA)
table3 = select(rename(participant,subject=name),subject,sex,age)
cleaned = inner_join(inner_join(table1,table2),table3)
cleaned
WEB = "https://en.wikipedia.org/wiki/NBA_Most_Valuable_Player"
MVP =    WEB %>%
read_html() %>%
html_table() %>%
.[[8]] %>%
.[1:9,-3]
print(MVP)
inner_join(results,education,by=c("subject"="name"))
anti_join(participant,education,by=join_by(name))
model = lm(Change~GPA+sex,data=cleaned)
round(model$coefficients)
select(participant,5)
random = sample((1:8,size = 5))
sample(8)
15/19
14/19
13/19
13/18
12/18
3:26
ends_width(c("start,finish"),"in")
# This is a good place to put libraries required for using the ggplot function
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
ends_with(c("start,finish"),"in")
library(nycflights13)
library(nycflights13)
flights$arr_time
flights$air_time
names(flights)
flights[[15]]
median(flights$air_time)
median(flights$air_time,na.rm=T)
flights[,15]
median(flights[,15],na.rm=T)
median(flights$air_time,na.rm=T)
flights$"air_time"
flights %>%
filter(air_time>120)
library(tidyverse)
flights %>%
filter(air_time>120)
flights %>%
filter("air_time">120)
flight2 = flights %>%
filter("air_time">120)
dim(flight2)
flight2 = flights %>%
filter(air_time>120)
dim(flight2)
air_time
flights[,"air_time"]
air_tim
flights[,air_time]
flights[,air_time]
air_time=c(1,3,5)
flights[,air_time]
select(flights,"air_time")
select(flights,air_time)
1:10
paste("Data",1:10)
paste("Data",1:10,sep="_")
unite(flights,year,month,day,sep="/")
unite(flights,date,year,month,day,sep="/")
out=unite(flights,date,year,month,day,sep="/")
View(out)
out=unite(flights,date,c(year,month,day),sep="/")
out
out=mutate(flights,date=paste(year,month,day,sep="?"))
out
View(out)
out=mutate(flights,date=paste(year,month,day,sep="/"))
out
View(out)
out=mutate(flights,date=as.numeric(paste(year,month,day,sep="")))
out
View(out)
library(ggmap)
install.packages("ggmap")
library(ggmap)
get_map("Chapel Hill")
get_map("Chapel Hill",source=="osm")
get_map("Chapel Hill",source="osm")
get_map("Chapel Hill",source="osm")
get_map("Chapel Hill",source="stadia")
get_map(source="osm")
get_map(maptype="terrain",source="osm")
get_map(scale=get_openstreetmap(),maptype="terrain",source="osm")
ggmap(map)
(map <- get_map("orlando, florida"))
ggmap(map)
(map <- get_map("orlando, florida"))
ggmap::register_google()
(map <- get_map("orlando, florida"))
ggmap(map)
(map <- get_map(source = "stadia", maptype = "stamen_watercolor"))
map <- get_map(location = "texas", zoom = 6, source = "stadia")
map <- get_map(location = "texas", zoom = 6, source = "stadia")
ggmap(map, fullpage = TRUE)
map <- get_map(location = "texas", zoom = 6, source = "stadia")
register_google("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the ggmap package
set.api.key("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the gmapsdistance package
register_google("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the ggmap package
set.api.key("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the gmapsdistance package
register_google("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the ggmap package
set.api.key("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the gmapsdistance package
register_google("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the ggmap package
set.api.key("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the gmapsdistance package
install.packages("gmapsdistance")
register_google("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the ggmap package
set.api.key("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the gmapsdistance package
library(gmapsdistance)
library(knitr)
register_google("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the ggmap package
set.api.key("AIzaSyAQz1nc385W8RsjpJ6w9iilWCYfRBtW7xE") #for the gmapsdistance package
Tempe_Map <- get_map("Tempe", source="google", api_key = apiKey, zoom=12)
ggmap(Tempe_Map)
Tempe_Map <- get_map("Chapel HIll", source="google", api_key = apiKey, zoom=12)
ggmap(Tempe_Map)
Tempe_Map <- get_map("Chapel Hill", source="google", api_key = apiKey, zoom=12)
ggmap(Tempe_Map)
Tempe_Map <- get_map("Brier Creek", source="google", api_key = apiKey, zoom=12)
ggmap(Tempe_Map)
4.47*(1+0.206)^6
4.47*(1+0.206)^7
4.47*(1+0.206)^6
4.47*(1+0.206)^5
4.47*(1+0.206)6
4.47*(1+0.206)^6
5.68*(1+0.206)^6
5.68*(1+0.206)^5
19.76*(1+0.109)^5
19.769*(1+0.109)^5
20+(520/4329)*10
20*(4329-520)/4329 +10
20*(4329-520)/4329 +10
9*12
0.4*4+0.5*3+0.2*2
0.4*4+0.5*3+0.1*2
sqrt(365.93)
sqrt(3659.3)
install.packages("wehoop")
#Libraries
library(tidyverse)
library(rvest) #Webscraping
library(XML)
library(RCurl)
library(httr)
library(httr2)
library(RSelenium)
#Webscrape All Schools
Stats_URL="https://www.sports-reference.com/cbb/seasons/women/2025-school-stats.html"
ALL=read_html(Stats_URL) %>%
html_table() %>%
.[[1]]
install.packages("wehoop")
rselenium
selenium()
library(wehoop)
# New page
library(wehoop)
tictoc::tic()
progressr::with_progress({
wnba_pbp <- wehoop::load_wnba_pbp()
})
tictoc::toc()
install.packages("tictoc")
library(wehoop)
tictoc::tic()
progressr::with_progress({
wnba_pbp <- wehoop::load_wnba_pbp()
})
tictoc::toc()
View(wnba_pbp)
tictoc::tic()
progressr::with_progress({
player_box=load_wbb_player_box()
})
tictoc::toc()
tictoc::tic()
progressr::with_progress({
player_box=load_wbb_player_box(seasons=2025)
})
tictoc::toc()
View(player_box)
espn_wbb_player_stats(year=2025)
espn_wbb_player_stats(year=2025,total=TRUE)
player_box=load_wbb_player_box()
player_box=load_wbb_player_box()
player_box=load_wbb_player_box(seasons=2025)
View(player_box)
unique_id=unique(player_box$athlete_id)
espn_wbb_player_stats(athlete_id=unique_id)
espn_wbb_player_stats(athlete_id=unique_id,year=2025)
espn_wbb_player_stats(athlete_id=unique_id[1],year=2025)
out=espn_wbb_player_stats(athlete_id=unique_id[1],year=2025)
View(out)
names(out)
out$offensive_points
out$defensive_blocks
out$full_name
out$defensive_blocks
View(out)
out$offensive_points
out=espn_wbb_player_stats(athlete_id=unique_id[1],year=2024)
out$defensive_blocks
out$full_name
player_box=load_wbb_player_box(seasons=2024)
unique_id=unique(player_box$athlete_id)
unique_id
out=espn_wbb_player_stats(athlete_id=unique_id[1],year=2024)
out$defensive_blocks
out$full_name
player_box=load_wbb_player_box(seasons=2025)
unique_id=unique(player_box$athlete_id)
out=espn_wbb_player_stats(athlete_id=unique_id[1],year=2025)
out$defensive_blocks
out$full_name
out=espn_wbb_player_stats(athlete_id=unique_id[1],year=2025,total=TRUE)
out$defensive_blocks
?espn_wbb_player_stats
out=espn_wbb_player_stats(athlete_id=unique_id[1],year=2025,total=TRUE)
out$defensive_blocks
out$general_rebounds
out=espn_wbb_player_stats(athlete_id=unique_id[1],year=2025,total=FALSE)
out$defensive_blocks
out$full_name
out$team_name
out=espn_wbb_player_stats(athlete_id=unique_id[1],year=2025,total=TRUE)
out$defensive_blocks
out$full_name
out$team_name
out=espn_wbb_player_stats(athlete_id=unique_id[1],year=2024,total=TRUE)
out$defensive_blocks
out=espn_wbb_player_stats(athlete_id=unique_id[2],year=2025,total=TRUE)
out$defensive_blocks
out$full_name
out$team_name
out=espn_wbb_player_stats(athlete_id=unique_id[3],year=2025,total=TRUE)
out$defensive_blocks
out$full_name
out$team_name
out$offensive_points
out$general_per
out$general_plus_minus
out$offensive_offensive_rebounds
filter(player_box,athlete_id==unique_id[1])
SStrong=filter(player_box,athlete_id==unique_id[1])
View(SStrong)
View(out)
View(out)
View(SStrong)
out=espn_wbb_player_stats(athlete_id=unique_id[1],year=2025,total=TRUE)
out$defensive_blocks
sum(SStrong$blocks)
sum(SStrong$offensive_rebounds)
try(espn_wbb_player_stats(athlete_id = 2984250, year = 2022))
out2=espn_wbb_player_stats(athlete_id = 2984250, year = 2022)
View(out2)
out2$defensive_steals
out2$defensive_avg_steals
library(rselenium)
install.packages("rsele")
library(RSelenium)
library(wdman)
library(netstat)
install.packages("netstat")
library(RSelenium)
library(wdman)
library(netstat)
selenium()
library(RSelenium)
library(wdman)
library(netstat)
selenium()
selenium(phantomver=NULL)
selenium <- selenium(retcommand=T,check=F)
selenium <- selenium(retcommand=T,check=F,phantomver=NULL)
selenium
#Google Chrome
binman::list_versions("chromever")
#Google Chrome
binman::list_versions("chromedriver")
binman::list_versions("chromedriver")
remote_driver = rsDriver(browswer="chrome",
chromever="114.0.5735.90"
verbose=F,
binman::list_versions("chromedriver")
remote_driver = rsDriver(browswer="chrome",
chromever="114.0.5735.90",
verbose=F,
port=free_port())
binman::list_versions("chromedriver")
remote_driver = rsDriver(browser="chrome",
chromever="114.0.5735.90",
verbose=F,
port=free_port(),
phantomver=NULL)
binman::list_versions("chromedriver")
remote_driver = rsDriver(browser="chrome",
chromever="114.0.5735.90",
verbose=F,
port=free_port())
#Google Chrome
binman::list_versions("chromedriver")
binman::list_versions("chromedriver")
remote_driver = rsDriver(browser="chrome",
chromever="113.0.5672.63",
verbose=F,
port=free_port())
binman::list_versions("chromedriver")
remote_driver = rsDriver(browser="chrome",
chromever="113.0.5672.63",
verbose=F,
port=free_port(),
phantomver=NULL)
remote_driver = rsDriver(browser="chrome",
chromever="141.0.7390.123",
verbose=F,
port=free_port(),
phantomver=NULL)
#Google Chrome
binman::list_versions("chromedriver")
remote_driver = rsDriver(browser="chrome",
chromever="141.0.7390.123",
verbose=F,
phantomver=NULL)
binman::list_versions("chromedriver")
remote_driver = rsDriver(browser="chrome",
chromever="114.0.5735.90",
verbose=F,
phantomver=NULL)
binman::install_driver()
library(wdman)
binman::install_driver(appname = "chromedriver", version = "141.0.7390.54")
remote_driver = rsDriver(browser="chrome",
chromever="141.0.7390.54",
verbose=F,
phantomver=NULL)
remote_driver = rsDriver(browser="chrome",
chromever="141.0.7390.54",
verbose=F,
phantomver=NULL)
rs_driver_obj <- rsDriver(browser = "chrome")
rs_driver_obj <- rsDriver(browser = "chrome",phantomver=NULL)
client <- rs_driver_obj$client
rs_driver_obj <- rsDriver(browser = "chrome",phantomver=NULL,port=free_port())
rD[["server"]]$stop()
remote_driver[["server"]]$stop()
rs_driver_obj <- rsDriver(browser = "chrome",phantomver=NULL,port=free_port())
remote_driver[["server"]]$stop()
remote_driver[["server"]]$stop()
#Google Chrome
binman::list_versions("chromedriver")
library(binman)
binman::list_versions("chromedriver")
remote_driver = rsDriver(browser="chrome",
chromever="141.0.7390.54",
verbose=F,
phantomver=NULL)
#Libraries
library(tidyverse)
library(rvest) #Webscraping
library(XML)
library(RCurl)
library(httr)
library(httr2)
library(RSelenium)
#Webscrape All Schools
Stats_URL="https://www.sports-reference.com/cbb/seasons/women/2025-school-stats.html"
ALL=read_html(Stats_URL) %>%
html_table() %>%
.[[1]]
names(ALL)=ALL[1,]
ALL2=ALL[ALL$G != "Overall",]
ALL3=ALL2[ALL2$School != "School" ,]
SCHOOLS=ALL3$School #Observe School Names and Observe Website for Specific School
SCHOOLS
3*(1/0.3)+4*(1/0.4)
3*0.3+4*0.4
p1=0.3
p2=0.4
p1=0.3
p2=0.4
(1-p1)/p1^2
(1-p1)/p1^2
(1-p2)/p2^2
sqrt(9*(1-p1)/p1^2 + 16*(1-p2)/p2^2)
9*(1-p1)/p1^2 + 16*(1-p2)/p2^2
3*(1-p1)/p1^2 + 4*(1-p2)/p2^2
10/3
.208-.095
.208+.095
20/36
library(DT)
library(tidyverse)
library(readxl)
library(plyr)
setwd("D:/DoctorMario/UNC/STOR 538/STOR538_WEBSITE/Playoff")
Actual=read.csv(file="Actual.csv",fileEncoding="latin1")
Actual$Home=gsub('^.', '', Actual$Home)
Actual$Away=gsub('^.', '', Actual$Away)
Actual[58,2]="Miami Dolphins"
Actual=Actual[,c(1,2,3,5,4,6)]
Actual=dplyr::rename(Actual,Total=Total.Points,Pass=Total.Passing.Yards)
P1=read.csv(file="Predictions_1.csv")
P2=read.csv(file="Predictions_2.csv")
P2[58,2]="Miami Dolphins"
P3=read.csv(file="Predictions_3.csv",fileEncoding="latin1")
P3$Home=gsub('^.', '', P3$Home)
P3$Away=gsub('^.', '', P3$Away)
P3[58,2]="Miami Dolphins"
P4=read.csv(file="Predictions_4.csv")
P5=read.csv(file="Predictions_5.csv")
P5$Home=gsub('^.', '', P5$Home)
P5$Away=gsub('^.', '', P5$Away)
P5[58,2]="Miami Dolphins"
P6=read.csv(file="Predictions_6.csv",fileEncoding="latin1")
P6$Home=gsub('^.', '', P6$Home)
P6$Away=gsub('^.', '', P6$Away)
P6[58,2]="Miami Dolphins"
P7=read.csv(file="Predictions_7.csv")
P8=read.csv(file="Predictions_8.csv")
P8$Home=gsub('^.', '', P8$Home)
P8$Away=gsub('^.', '', P8$Away)
P9=read.csv(file="Predictions_9.csv")
P9$Home=gsub('^.', '', P9$Home)
P9$Away=gsub('^.', '', P9$Away)
P9[58,2]="Miami Dolphins"
SPREAD=join_all(list(dplyr::rename(P1,Spread_1=Spread)[,1:4],
dplyr::rename(P2,Spread_2=Spread)[,1:4],
dplyr::rename(P3,Spread_3=Spread)[,1:4],
dplyr::rename(P4,Spread_4=Spread)[,1:4],
dplyr::rename(P5,Spread_5=Spread)[,1:4],
dplyr::rename(P6,Spread_6=Spread)[,1:4],
dplyr::rename(P7,Spread_7=Spread)[,1:4],
dplyr::rename(P8,Spread_8=Spread)[,1:4],
dplyr::rename(P9,Spread_9=Spread)[,1:4]),
by=c("Week","Home","Away"),type="left")
TOTAL=join_all(list(dplyr::rename(P1,Total_1=Total)[,c(1:3,5)],
dplyr::rename(P2,Total_2=Total)[,c(1:3,5)],
dplyr::rename(P3,Total_3=Total)[,c(1:3,5)],
dplyr::rename(P4,Total_4=Total)[,c(1:3,5)],
dplyr::rename(P5,Total_5=Total)[,c(1:3,5)],
dplyr::rename(P6,Total_6=Total)[,c(1:3,5)],
dplyr::rename(P7,Total_7=Total)[,c(1:3,5)],
dplyr::rename(P8,Total_8=Total)[,c(1:3,5)],
dplyr::rename(P9,Total_9=Total)[,c(1:3,5)]),
by=c("Week","Home","Away"),type="left")
PASS=join_all(list(dplyr::rename(P1,Pass_1=Pass)[,c(1:3,6)],
dplyr::rename(P2,Pass_2=Pass)[,c(1:3,6)],
dplyr::rename(P3,Pass_3=Pass)[,c(1:3,6)],
dplyr::rename(P4,Pass_4=Pass)[,c(1:3,6)],
dplyr::rename(P5,Pass_5=Pass)[,c(1:3,6)],
dplyr::rename(P6,Pass_6=Pass)[,c(1:3,6)],
dplyr::rename(P7,Pass_7=Pass)[,c(1:3,6)],
dplyr::rename(P8,Pass_8=Pass)[,c(1:3,6)],
dplyr::rename(P9,Pass_9=Pass)[,c(1:3,6)]),
by=c("Week","Home","Away"),type="left")
write.csv(dplyr::select(mutate(SPREAD,Actual=Actual$Spread),"Week","Home","Away","Actual",everything()),"SPREAD_class.csv")
write.csv(dplyr::select(mutate(TOTAL,Actual=Actual$Total),"Week","Home","Away","Actual",everything()),"TOTAL_class.csv")
write.csv(dplyr::select(mutate(PASS,Actual=Actual$Pass),"Week","Home","Away","Actual",everything()),"PASS_class.csv")
mae.func=function(prediction,actual){
mean(abs(actual-prediction),na.rm=T)
}
SPREAD.RESULT=apply(SPREAD[,-(1:3)],2,mae.func,actual=Actual$Spread)
SPREAD.RANK=rank(SPREAD.RESULT)
TOTAL.RESULT=apply(TOTAL[,-(1:3)],2,mae.func,actual=Actual$Total)
TOTAL.RANK=rank(TOTAL.RESULT)
PASS.RESULT=apply(PASS[,-(1:3)],2,mae.func,actual=Actual$Pass)
PASS.RANK=rank(PASS.RESULT)
Group = c(1:9)
Class_Results = tibble(Group=Group,
`Spread MAE`=SPREAD.RESULT,
`Spread Rank`=SPREAD.RANK,
`Total MAE`=TOTAL.RESULT,
`Total Rank`=TOTAL.RANK,
`Pass MAE`=PASS.RESULT,
`Pass Rank`=PASS.RANK)
write.csv(Class_Results,"Class_Results.csv",row.names=F)
