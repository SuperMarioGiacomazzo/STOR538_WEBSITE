group_by(reviewer_id) %>%
summarize(n=n())
mean.n=mean(out$n)
median.n=median(out$n)
prop.n=mean(out$n==1)
ggplot(data=out) +
geom_histogram(aes(x=n)) +
geom_text(x=30,y=50000,label="Mean: 1.07",size=8)+
geom_text(x=30,y=40000,label="Median: 1",size=8)+
geom_text(x=25,y=30000,label="Prop with 1 Review: 0.95",size=8)
ggplot(data=out) +
geom_text(x=30,y=50000,label="Mean: 1.07",size=8)+
geom_text(x=30,y=40000,label="Median: 1",size=8)+
geom_text(x=25,y=30000,label="Prop with 1 Review: 0.95",size=8)
ggplot(data=out) +
geom_text(x=30,y=50000,label="Mean: 1.07",size=8)+
geom_text(x=30,y=40000,label="Median: 1",size=8)+
geom_text(x=25,y=30000,label="Prop with 1 Review: 0.95",size=8)
ggplot(data=out) +
geom_histogram(aes(x=n)) +
geom_text(x=30,y=50000,label="Mean: 1.07",size=8)+
geom_text(x=30,y=40000,label="Median: 1",size=8)+
geom_text(x=25,y=30000,label="Prop with 1 Review: 0.95",size=8)
out=reviews %>%
group_by(reviewer_id) %>%
summarize(n=n())
mean.n=mean(out$n)
median.n=median(out$n)
prop.n=mean(out$n==1)
ggplot(data=out) +
geom_histogram(aes(x=n)) +
geom_text(x=30,y=50000,label="Mean: 1.07",size=8)+
geom_text(x=30,y=40000,label="Median: 1",size=8)+
geom_text(x=25,y=30000,label="Prop with 1 Review: 0.95",size=8) +
xlabel("Number of Reviews")
out=reviews %>%
group_by(reviewer_id) %>%
summarize(n=n())
mean.n=mean(out$n)
median.n=median(out$n)
prop.n=mean(out$n==1)
ggplot(data=out) +
geom_histogram(aes(x=n)) +
geom_text(x=30,y=50000,label="Mean: 1.07",size=8)+
geom_text(x=30,y=40000,label="Median: 1",size=8)+
geom_text(x=25,y=30000,label="Prop with 1 Review: 0.95",size=8) +
xlab("Number of Reviews")
out=reviews %>%
group_by(reviewer_id) %>%
summarize(n=n())
mean.n=mean(out$n)
median.n=median(out$n)
prop.n=mean(out$n==1)
ggplot(data=out) +
geom_histogram(aes(x=n)) +
geom_text(x=30,y=50000,label="Mean: 1.07",size=8)+
geom_text(x=30,y=40000,label="Median: 1",size=8)+
geom_text(x=25,y=30000,label="Prop with 1 Review: 0.95",size=8) +
xlab("Number of Reviews")
out=reviews %>%
group_by(reviewer_id) %>%
summarize(n=n())
mean.n=mean(out$n)
median.n=median(out$n)
prop.n=mean(out$n==1)
ggplot(data=out) +
geom_histogram(aes(x=n)) +
geom_text(x=30,y=50000,label="Mean: 1.07",size=8)+
geom_text(x=30,y=40000,label="Median: 1",size=8)+
geom_text(x=25,y=30000,label="Prop with 1 Review: 0.95",size=8) +
xlab("Number of Reviews")
#Wrong (Used for Example Graphic)
ggplot(data=out) +
geom_histogram(aes(x=n)) +
geom_text(x=30,y=50000,label="Mean: 1.92",size=8)+
geom_text(x=30,y=40000,label="Median: 2",size=8)+
geom_text(x=25,y=30000,label="Prop with 1 Review: 0.87",size=8) +
xlab("Number of Reviews")
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(DT)
library(tidyverse)
setwd("D:/Mario Documents/UNC/STOR 320/STOR320_WEBSITE/Group Assignments")
Groups1=read.csv(file="STOR320.002 Group Assignments.csv")
datatable(Groups1,class="display",options = list(scrollX=F,
columnDefs = list(list(className = 'dt-center', targets = 0:5))),rownames=F)
Groups=read.csv(file="STOR520.001 Group Assignments.csv")
Groups=read.csv(file="STOR520.001 Group Assignments.csv")
Groups=read.csv(file="STOR520.001 Group Assignments.csv")
Groups2=read.csv(file="STOR520.001 Group Assignments.csv")
Groups2=read.csv(file="STOR520.001 Group Assignments.csv")
Groups2=read.csv(file="STOR520.001 Group Assignments.csv")
Groups2=read.csv(file="STOR520.001 Group Assignments.csv")
read.csv(file="STOR520.001 Group Assignments.csv")
setwd("D:/Mario Documents/UNC/STOR 320/STOR320_WEBSITE/Group Assignments")
Groups1=read.csv(file="STOR320.002 Group Assignments.csv")
library(DT)
library(tidyverse)
setwd("D:/Mario Documents/UNC/STOR 320/STOR320_WEBSITE/Group Assignments")
Groups1=read.csv(file="STOR320.002 Group Assignments.csv")
datatable(Groups1,class="display",options = list(scrollX=F,
columnDefs = list(list(className = 'dt-center', targets = 0:5))),rownames=F)
library(DT)
library(tidyverse)
setwd("D:/Mario Documents/UNC/STOR 320/STOR320_WEBSITE/Group Assignments")
Groups1=read.csv(file="STOR320.002 Group Assignments.csv")
datatable(Groups1,class="display",options = list(scrollX=F,
columnDefs = list(list(className = 'dt-center', targets = 0:5))),rownames=F)
Groups2=read.csv(file="STOR520.001 Group Assignments.csv")
Groups2=read.csv(file="STOR520.001 Group Assignments.csv")
Groups2=read.csv(file="STOR520.001 Group Assignments.csv")
Groups2=read.csv(file="STOR520.001 Group Assignments.csv")
read.csv(file="STOR520.001 Group Assignments.csv")
library(DT)
library(tidyverse)
setwd("D:/Mario Documents/UNC/STOR 320/STOR320_WEBSITE/Group Assignments")
Groups1=read.csv(file="STOR520.001 Group Assignments.csv")
datatable(Groups1,class="display",options = list(scrollX=F,
columnDefs = list(list(className = 'dt-center', targets = 0:5))),rownames=F)
library(DT)
library(tidyverse)
setwd("D:/Mario Documents/UNC/STOR 320/STOR320_WEBSITE/Group Assignments")
Groups1=read.csv(file="STOR320.002 Group Assignments.csv")
datatable(Groups1,class="display",options = list(scrollX=F,
columnDefs = list(list(className = 'dt-center', targets = 0:5))),rownames=F)
library(DT)
library(tidyverse)
setwd("D:/Mario Documents/UNC/STOR 320/STOR320_WEBSITE/Group Assignments")
Groups2=read.csv(file="STOR520.001 Group Assignments.csv")
datatable(Groups2,class="display",options = list(scrollX=F,
columnDefs = list(list(className = 'dt-center', targets = 0:5))),rownames=F)
read.csv(file="STOR320.002 Group Assignments.csv")
Groups1
arrange(Groups1, Group)
library(DT)
library(tidyverse)
setwd("D:/Mario Documents/UNC/STOR 320/STOR320_WEBSITE/Group Assignments")
Groups1=read.csv(file="STOR320.002 Group Assignments.csv")
arrange(Groups1, Group) %>%
datatable(class="display",options = list(scrollX=F,
columnDefs = list(list(className = 'dt-center', targets = 0:5))),rownames=F)
library(noncensus)    #Contains Zip Codes for US Cities
knitr::opts_chunk$set(echo = TRUE,warning=F)
options(scipen=999)
library(tidyverse)    #Essential Functions
library(rvest)        #Read Tables From Webpages
URL.VIOLENT="https://en.wikipedia.org/wiki/List_of_United_States_cities_by_crime_rate#Crime_rates_per_100.2C000_people_.282012.29"
VIOLENT = URL.VIOLENT %>%
read_html() %>%
html_table(fill=TRUE) %>%
.[[1]]
str(VIOLENT)
VIOLENT2=VIOLENT[-(1:2),1:8]
colnames(VIOLENT2)=c("State","City","Population","Total","Murder","Rape","Robbery","Assault")
str(VIOLENT2)
VIOLENT3=VIOLENT2 %>%
mutate(Population=str_replace_all(Population,pattern=",",replacement="")) %>%
mutate_at(3:8,as.numeric)
str(VIOLENT3)
VIOLENT3[str_detect(VIOLENT3$City,"[,(0-9)]{1}"),]$City
VIOLENT3[str_detect(VIOLENT3$City,"[,(0-9)]{1}"),]$City
VIOLENT3[str_detect(VIOLENT3$City,"[:digit:]"),]$City
VIOLENT3[str_detect(VIOLENT3$City,"[,(0-9)]{1}"),]$City
VIOLENT4 = VIOLENT3 %>%
mutate(City=str_replace_all(City,"[,(0-9)]{1}","")) %>%
mutate(State=str_replace_all(State,"[,(0-9)]{1}",""))
VIOLENT5 = VIOLENT4 %>%
mutate(City=ifelse(City=="Charlotte-Mecklenburg","Charlotte",City))
VIOLENT6 = VIOLENT5 %>%
mutate(City=str_replace(City," Metro",""))
write_csv(VIOLENT6,"FINAL_VIOLENT.CSV")
View(VIOLENT6)
knitr::opts_chunk$set(echo = TRUE,warning=F)
options(scipen=999)
library(tidyverse)    #Essential Functions
library(rvest)        #Read Tables From Webpages
VIOLENT=read_csv("FINAL_VIOLENT.CSV")
ZIP=read_csv("FINAL_ZIP.CSV")
ABBREV=read_csv("FINAL_STATE_ABBREV.CSV")
knitr::opts_chunk$set(echo = TRUE,warning=F)
options(scipen=999)
library(tidyverse)    #Essential Functions
library(rvest)        #Read Tables From Webpages
#install.packages("devtools")
library(devtools)
#install_github("cran/noncensus",force=TRUE)
library(noncensus)    #Contains Zip Codes for US Cities
STATE_ABBREV_TOP = STATE_ABBREV[,1:2]
URL.STATE_ABBREV = "https://state.1keydata.com/state-abbreviations.php"
STATE_ABBREV = URL.STATE_ABBREV %>%
read_html() %>%
html_table(fill=T) %>%
.[[3]] %>%
.[-1,]
head(STATE_ABBREV)
STATE_ABBREV_TOP = STATE_ABBREV[,1:2]
names(STATE_ABBREV_TOP)=c("State","Abbrev")
STATE_ABBREV_BOT = STATE_ABBREV[,3:4]
names(STATE_ABBREV_BOT)=c("State","Abbrev")
STATE_ABBREV2=rbind(STATE_ABBREV_TOP,STATE_ABBREV_BOT) %>% arrange(State)
head(STATE_ABBREV2)
write_csv(STATE_ABBREV2,"FINAL_STATE_ABBREV.CSV")
URL.US_CENSUS = "https://www.citypopulation.de/en/usa/cities/"
US_CENSUS = URL.US_CENSUS %>%
read_html() %>%
html_table(header=T,fill=T) %>%
.[[3]] %>%
select(c(2,4,8,9,10))
US_CENSUS
str(US_CENSUS)
View(US_CENSUS)
URL.US_CENSUS %>%
read_html() %>%
html_table(header=T,fill=T)
ve
setwd("D:/Mario Documents/UNC/STOR 538/STOR538_WEBSITE/Slides/Sports Analytics 1")
library(tidyverse)
library(forcats)
DATA=read.csv("Sports Analytics Survey.csv")[,-(1:4)]
View(DATA)
names(DATA)=c("Year","MajorMinor","R Experience","Graduation","Watch","Participated","Other")
DATA2=separate(data=DATA,col=Watch,into=paste("Watch",1:33),sep=";")
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:27),sep=";")
table(DATA3$Year)
png('RExp.png',width=1200,height=800)
par(mar=c(3,4,3,2),cex=1.5,cex.main=2.5)
barplot(table(DATA3$`R Experience`)/nrow(DATA3),ylim=c(0,1),main="R Experience")
dev.off()
DATA4=DATA3 %>% mutate(Graduation=factor(Graduation))
levels(DATA4$Graduation)=c("Doctoral","Not Sports Analytics","Sports Analytics","Master's","Professional")
DATA4=DATA4 %>% mutate(Graduation = fct_infreq(Graduation))
png('Graduation.png',width=1200,height=800)
par(mar=c(12,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(DATA4$`Graduation`)/nrow(DATA3),las=2,ylim=c(0,1),main="Graduation Goal")
dev.off()
table(DATA3$Year)
DATA3$Year
table(DATA3$Year)
par(mar=c(3,4,3,2),cex=2,cex.main=2.5)
barplot(table(DATA3$`R Experience`)/nrow(DATA3),ylim=c(0,1),main="R Experience")
png('RExp.png',width=1200,height=800)
par(mar=c(3,4,3,2),cex=2,cex.main=2.5)
barplot(table(DATA3$`R Experience`)/nrow(DATA3),ylim=c(0,1),main="R Experience")
dev.off()
DATA4=DATA3 %>% mutate(Graduation=factor(Graduation))
levels(DATA4$Graduation)=c("Doctoral","Not Sports Analytics","Sports Analytics","Master's","Professional")
DATA4=DATA4 %>% mutate(Graduation = fct_infreq(Graduation))
png('Graduation.png',width=1200,height=800)
par(mar=c(12,3,3,1),cex=2,cex.main=2.5)
barplot(table(DATA4$`Graduation`)/nrow(DATA3),las=2,ylim=c(0,1),main="Graduation Goal")
dev.off()
View(DATA4)
DATA2=separate(data=DATA,col=Watch,into=paste("Watch",1:27),sep=";")
View(DATA2)
View(DATA4)
View(DATA4)
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:27),sep=";")
View(DATA3)
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:20),sep=";")
table(DATA3$Year)
View(DATA3)
DATA3$`Part 19`
DATA3$`Part 20`
DATA3$`Part 21`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:21),sep=";")
DATA3$`Part 21`
DATA3$`Part 22`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:22),sep=";")
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:22),sep=";")
DATA3$`Part 22`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:23),sep=";")
DATA3$`Part 22`
DATA3$`Part 23`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:24),sep=";")
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:24),sep=";")
DATA3$`Part 24`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:24),sep=";")
DATA3$`Part 24`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:25),sep=";")
DATA3$`Part 25`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:26),sep=";")
DATA3$`Part 26`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:27),sep=";")
DATA3$`Part 27`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:28),sep=";")
DATA3$`Part 28`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:29),sep=";")
DATA3$`Part 29`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:30),sep=";")
DATA3$`Part 30`
DATA3$`Part 31`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:31),sep=";")
DATA3$`Part 31`
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:30),sep=";")
View(DATA3)
table(DATA3$Year)
View(DATA4)
setwd("D:/Mario Documents/UNC/STOR 538/STOR538_WEBSITE/Slides/Sports Analytics 1")
library(tidyverse)
library(forcats)
DATA=read.csv("Sports Analytics Survey.csv")[,-(1:4)]
names(DATA)=c("Year","MajorMinor","R Experience","Graduation","Watch","Participated","Other")
DATA2=separate(data=DATA,col=Watch,into=paste("Watch",1:27),sep=";")
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:30),sep=";")
table(DATA3$Year)
png('RExp.png',width=1200,height=800)
par(mar=c(3,4,3,2),cex=2,cex.main=2.5)
barplot(table(DATA3$`R Experience`)/nrow(DATA3),ylim=c(0,1),main="R Experience")
dev.off()
DATA4=DATA3 %>% mutate(Graduation=factor(Graduation))
levels(DATA4$Graduation)=c("Doctoral","Not Sports Analytics","Sports Analytics","Master's","Professional")
DATA4=DATA4 %>% mutate(Graduation = fct_infreq(Graduation))
png('Graduation.png',width=1200,height=800)
par(mar=c(12,3,3,1),cex=2,cex.main=2.5)
barplot(table(DATA4$`Graduation`)/nrow(DATA3),las=2,ylim=c(0,1),main="Graduation Goal")
dev.off()
View(DATA4)
names(DATA4)[5:32]
names(DATA4)[5:31]
sportswatched =  na.omit(gather(data=DATA4,5:31,key="Watch",value="Sport")$Sport)
unique(sportswatched)
unique(sportswatched)
sportswatched2 = ifelse(sportswatched==unique(sportswatched)[10],"Arcade",sportswatched)
sportswatched3 = ifelse(sportswatched2==unique(sportswatched)[9],"Combat Sports",sportswatched2)
sportswatched4 = ifelse(sportswatched3==unique(sportswatched)[3],"Auto/Bike Racing",sportswatched3)
sportswatched5 = ifelse(sportswatched4==unique(sportswatched)[38],"Yard Games",sportswatched4)
sportswatched6 = ifelse(sportswatched5==unique(sportswatched)[11],"Board Games",sportswatched5)
sportswatched7 = ifelse(sportswatched6==unique(sportswatched)[4],"Air Sports",sportswatched6)
unique(sportswatched7)
unique(sportswatched)[5]
sportswatched8 = ifelse(sportswatched7==unique(sportswatched)[5],"",sportswatched6)
unique(sportswatched8)
sportswatched8 = ifelse(sportswatched7==unique(sportswatched)[5],NULL,sportswatched6)
unique(sportswatched8)
sportswatched8 = ifelse(sportswatched7==unique(sportswatched)[5],NA,sportswatched6)
unique(sportswatched8)
sportswatched9 = na.omit(sportswatched8)
unique(sportswatched9)
png('Watched.png',width=1200,height=800)
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportswatched9),sportswatched9,.fun=table)),las=2,ylim=c(0,100),main="Sports Watched")
dev.off()
unique(sportswatched)
sportswatched2 = ifelse(sportswatched==unique(sportswatched)[10],"Arcade",sportswatched)
sportswatched3 = ifelse(sportswatched2==unique(sportswatched)[9],"Combat Sports",sportswatched2)
sportswatched4 = ifelse(sportswatched3==unique(sportswatched)[3],"Auto/Bike Racing",sportswatched3)
sportswatched5 = ifelse(sportswatched4==unique(sportswatched)[38],"Yard Games",sportswatched4)
sportswatched6 = ifelse(sportswatched5==unique(sportswatched)[11],"Board Games",sportswatched5)
sportswatched7 = ifelse(sportswatched6==unique(sportswatched)[4],"Air Sports",sportswatched6)
sportswatched8 = ifelse(sportswatched7==unique(sportswatched)[5],NA,sportswatched6)
sportswatched9 = na.omit(sportswatched8)
unique(sportswatched9)
sportswatched7
unique(sportswatched9)
unique(sportswatched)
unique(sportswatched)[4]
unique(sportswatched)
sportswatched2 = ifelse(sportswatched==unique(sportswatched)[10],"Arcade",sportswatched)
sportswatched3 = ifelse(sportswatched2==unique(sportswatched)[9],"Combat Sports",sportswatched2)
sportswatched4 = ifelse(sportswatched3==unique(sportswatched)[3],"Auto/Bike Racing",sportswatched3)
sportswatched5 = ifelse(sportswatched4==unique(sportswatched)[38],"Yard Games",sportswatched4)
sportswatched6 = ifelse(sportswatched5==unique(sportswatched)[11],"Board Games",sportswatched5)
sportswatched7 = ifelse(sportswatched6==unique(sportswatched)[4],"Air Sports",sportswatched6)
sportswatched8 = ifelse(sportswatched7==unique(sportswatched)[5],NA,sportswatched7)
sportswatched9 = na.omit(sportswatched8)
unique(sportswatched9)
png('Watched.png',width=1200,height=800)
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportswatched9),sportswatched9,.fun=table)),las=2,ylim=c(0,100),main="Sports Watched")
dev.off()
length(unique(sportswatched9))
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportswatched9),sportswatched9,.fun=table)),las=2,ylim=c(0,100),main="Sports Watched")
text(x=1,y=1,"55 Unique Sports")
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportswatched9),sportswatched9,.fun=table)),las=2,ylim=c(0,100),main="Sports Watched")
text(x="Air Sports",y=1,"55 Unique Sports")
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportswatched9),sportswatched9,.fun=table)),las=2,ylim=c(0,100),main="Sports Watched")
text(x="Air Sports",y=1,"55 Unique Sports")
png('Watched.png',width=1200,height=800)
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportswatched9),sportswatched9,.fun=table)),las=2,ylim=c(0,100),main="Sports Watched")
dev.off()
sportsplayed =  na.omit(gather(data=DATA4,32:62,key="Play",value="Sport")$Sport)
unique(sportsplayed)
unique(sportsplayed)
sportsplayed =  na.omit(gather(data=DATA4,32:61,key="Play",value="Sport")$Sport)
unique(sportsplayed)
sportsplayed2 = ifelse(sportsplayed==unique(sportsplayed)[5],"Arcade",sportsplayed)
unique(sportsplayed2)
sportsplayed3 = ifelse(sportsplayed2==unique(sportsplayed)[19],"Competitive Board Games",sportsplayed2)
unique(sportsplayed3)
sportsplayed2 = ifelse(sportsplayed==unique(sportsplayed)[5],"Arcade",sportsplayed)
sportsplayed3 = ifelse(sportsplayed2==unique(sportsplayed)[19],"Competitive Board Games",sportsplayed2)
sportsplayed4 = ifelse(sportsplayed3==unique(sportsplayed)[38],"Combat Sports",sportsplayed3)
sportsplayed5 = ifelse(sportsplayed4==unique(sportsplayed)[34],"Yard Games",sportsplayed4)
unique(sportsplayed5)
length(unique(sportsplayed5))
unique(sportsplayed5)
sportsplayed6 = ifelse(sportsplayed5==unique(sportsplayed)[32],"Auto/Bike Racing",sportsplayed5)
unique(sportsplayed6)
sportsplayed2 = ifelse(sportsplayed==unique(sportsplayed)[5],"Arcade",sportsplayed)
sportsplayed3 = ifelse(sportsplayed2==unique(sportsplayed)[19],"Competitive Board Games",sportsplayed2)
sportsplayed4 = ifelse(sportsplayed3==unique(sportsplayed)[38],"Combat Sports",sportsplayed3)
sportsplayed5 = ifelse(sportsplayed4==unique(sportsplayed)[34],"Yard Games",sportsplayed4)
sportsplayed6 = ifelse(sportsplayed5==unique(sportsplayed)[32],"Auto/Bike Racing",sportsplayed5)
sportsplayed7 = ifelse(sportsplayed6==unique(sportsplayed)[12],NA,sportsplayed6)
sportsplayed8 = na.omit(sportsplayed7)
unique(sportsplayed8)
length(unique(sportsplayed8))
png('Played.png',width=1200,height=800)
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportsplayed5),sportsplayed,.fun=table)),las=2,ylim=c(0,80),main="Sports Played")
dev.off()
unique(sportsplayed8)
png('Played.png',width=1200,height=800)
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportsplayed8),sportsplayed,.fun=table)),las=2,ylim=c(0,80),main="Sports Played")
dev.off()
sportsplayed8 = na.omit(sportsplayed7)
sportsplayed8
png('Played.png',width=1200,height=800)
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportsplayed8),sportsplayed,.fun=table)),las=2,ylim=c(0,80),main="Sports Played")
dev.off()
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportsplayed8),sportsplayed,.fun=table)),las=2,ylim=c(0,80),main="Sports Played")
table(fct_reorder(as.factor(sportsplayed8),sportsplayed,.fun=table))
table(sportsplayed8)
sportsplayed =  na.omit(gather(data=DATA4,32:61,key="Play",value="Sport")$Sport)
unique(sportsplayed)
sportsplayed2 = ifelse(sportsplayed==unique(sportsplayed)[5],"Arcade",sportsplayed)
sportsplayed3 = ifelse(sportsplayed2==unique(sportsplayed)[19],"Competitive Board Games",sportsplayed2)
sportsplayed4 = ifelse(sportsplayed3==unique(sportsplayed)[38],"Combat Sports",sportsplayed3)
sportsplayed5 = ifelse(sportsplayed4==unique(sportsplayed)[34],"Yard Games",sportsplayed4)
sportsplayed6 = ifelse(sportsplayed5==unique(sportsplayed)[32],"Auto/Bike Racing",sportsplayed5)
sportsplayed7 = ifelse(sportsplayed6==unique(sportsplayed)[12],NA,sportsplayed6)
sportsplayed8 = na.omit(sportsplayed7)
unique(sportsplayed8)
length(unique(sportsplayed8))
png('Played.png',width=1200,height=800)
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportsplayed8),sportsplayed,.fun=table)),las=2,ylim=c(0,60),main="Sports Played")
dev.off()
table(sportsplayed8)
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportsplayed8),sportsplayed,.fun=table)),las=2,ylim=c(0,60),main="Sports Played")
as.factor(sportsplayed8)
fct_reorder(as.factor(sportsplayed8),sportsplayed,.fun=table)
png('Played.png',width=1200,height=800)
par(mar=c(14,3,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportsplayed8),sportsplayed8,.fun=table)),las=2,ylim=c(0,60),main="Sports Played")
dev.off()
check=intersect(unique(sportswatched9),unique(sportsplayed8))
check
check=intersect(unique(sportswatched9),unique(sportsplayed8))
sportswatched10=na.omit(ifelse(sportswatched9 %in% check,sportswatched9,NA))
sportsplayed9=na.omit(ifelse(sportsplayed8 %in% check,sportsplayed8,NA))
png('Together.png',width=1400,height=700)
par(mar=c(13,3,1,1),cex=2)
barplot(table(sportswatched8),las=2,ylim=c(-70,70),col="red")
barplot(-table(sportsplayed6),las=2,ylim=c(-70,70),add=T,col="blue")
dev.off()
par(mar=c(13,3,1,1),cex=2)
barplot(table(sportswatched8),las=2,ylim=c(-70,70),col="red")
barplot(-table(sportsplayed6),las=2,ylim=c(-70,70),add=T,col="blue")
par(mar=c(13,3,1,1),cex=2)
barplot(table(sportswatched8),las=2,ylim=c(-70,70),col="red")
barplot(-table(sportsplayed6),las=2,ylim=c(-70,70),add=T,col="blue")
par(mar=c(13,3,1,1),cex=2)
barplot(table(sportswatched8),las=2,ylim=c(-70,70),col="red")
barplot(-table(sportsplayed6),las=2,ylim=c(-70,70),add=T,col="blue")
par(mar=c(13,3,1,1),cex=2)
barplot(table(sportswatched8),las=2,ylim=c(-70,70),col="red")
barplot(-table(sportsplayed6),las=2,ylim=c(-70,70),add=T,col="blue")
barplot(table(sportswatched10),las=2,ylim=c(-70,70),col="red")
barplot(-table(sportsplayed9),las=2,ylim=c(-70,70),add=T,col="blue")
par(mar=c(13,3,1,1),cex=2)
barplot(table(sportswatched10),las=2,ylim=c(-70,70),col="red")
barplot(-table(sportsplayed9),las=2,ylim=c(-70,70),add=T,col="blue")
png('Together.png',width=1400,height=700)
par(mar=c(13,3,1,1),cex=2)
barplot(table(sportswatched10),las=2,ylim=c(-70,70),col="red")
barplot(-table(sportsplayed9),las=2,ylim=c(-70,70),add=T,col="blue")
dev.off()
png('Together.png',width=1400,height=700)
par(mar=c(13,3,1,1),cex=2)
barplot(table(sportswatched10),las=2,ylim=c(-70,70),col="red")
barplot(-table(sportsplayed9),las=2,ylim=c(-70,70),add=T,col="blue")
dev.off()
setwd("D:/DoctorMario/UNC/STOR 538/STOR538_WEBSITE/Slides/Sports Analytics 1")
library(tidyverse)
library(forcats)
DATA=read.csv("Sports Analytics Survey.csv")[,-(1:4)]
names(DATA)=c("Year","MajorMinor","R Experience","Graduation","Watch","Participated","Other")
DATA2=separate(data=DATA,col=Watch,into=paste("Watch",1:37),sep=";")
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:24),sep=";")
table(DATA3$Year)
png('RExp.png',width=1200,height=800)
par(mar=c(3,4,3,2),cex=2,cex.main=2.5)
barplot(table(DATA3$`R Experience`)/nrow(DATA3),ylim=c(0,1),main="R Experience")
dev.off()
DATA4=DATA3 %>% mutate(Graduation=factor(Graduation))
levels(DATA4$Graduation)
levels(DATA4$Graduation)=c("Not Sports Analytics","Sports Analytics","Master's","Professional")
DATA4=DATA3 %>% mutate(Graduation=factor(Graduation))
levels(DATA4$Graduation)=c("Not Sports Analytics","Sports Analytics","Master's","Professional")
DATA4=DATA4 %>% mutate(Graduation = fct_infreq(Graduation))
png('Graduation.png',width=1200,height=800)
par(mar=c(12,3,3,1),cex=2,cex.main=2.5)
barplot(table(DATA4$`Graduation`)/nrow(DATA3),las=2,ylim=c(0,1),main="Graduation Goal")
dev.off()
