COEF=rep(NA,200)
P.VAL=rep(NA,200)
for(j in 1:200){
individual.mod=lm(y~.,data=SIM.DATA[,c(1,j+1)])
COEF[j]=coef(individual.mod)[2]
P.VAL[j]=summary(individual.mod)$coefficients[2,4]
}
KEEP=P.VAL<Cutoff
ACTUAL=c(rep("NonZero",10),rep("Zero",190))
tibble(ACTUAL=ACTUAL,KEEP=KEEP) %>%
table() %>% prop.table()
lm.model=lm(y~.,data=SIM.DATA[,c(1,which(KEEP)+1)])
param.est=lm.model$coefficients
param.conf=confint(lm.model)
param.lm=data.frame(cbind(param.est,param.conf))[-1,] #Remove Intercept
names(param.lm)=c("Estimate","Lower","Upper")
param.lm = param.lm %>%
mutate(Significant=factor(ifelse(0>Lower & 0<Upper,"No","Yes")))
ggplot(param.lm[1:5,]) +
geom_pointrange(aes(x=1:5,y=Estimate,ymin=Lower,ymax=Upper,color=Significant),size=2)+
theme_minimal()+
scale_color_manual(drop=F,values=c("lightskyblue2","gray"))+
xlab("X1:X5")
ggplot(param.lm[6:10,]) +
geom_pointrange(aes(x=6:10,y=Estimate,ymin=Lower,ymax=Upper,color=Significant),size=2)+
theme_minimal()+
scale_color_manual(values=c("lightskyblue2","gray"))+
xlab("X6:X10")
ggplot(param.lm[11:(dim(param.lm)[1]),]) +
geom_pointrange(aes(x=11:(dim(param.lm)[1]),y=Estimate,ymin=Lower,ymax=Upper,color=Significant))+
theme_minimal()+
scale_color_manual(values=c("lightskyblue2","gray"))+
xlab("X11:X200")
library(glmnet)
ridge.mod=glmnet(x=as.matrix(SIM.DATA[,-1]),
y=as.vector(SIM.DATA[,1]),
alpha=0)
plot(ridge.mod,xvar="lambda")
lasso.mod=glmnet(x=as.matrix(SIM.DATA[,-1]),
y=as.vector(SIM.DATA[,1]),
alpha=1)
plot(lasso.mod,xvar="lambda")
DATA=mpg
DATA2=DATA[,c("year","displ","cyl","drv","cty","hwy","fl","class")]
head(DATA2)
y=DATA2$hwy
X=model_matrix(DATA2,hwy~.*.)[,-1]
var.names=names(X)
dim(X)
set.seed(216)
cvmod.0=cv.glmnet(y=y,x=as.matrix(X),alpha=0)
set.seed(216)
cvmod.25=cv.glmnet(y=y,x=as.matrix(X),alpha=0.25)
set.seed(216)
cvmod.5=cv.glmnet(y=y,x=as.matrix(X),alpha=0.5)
set.seed(216)
cvmod.75=cv.glmnet(y=y,x=as.matrix(X),alpha=0.75)
set.seed(216)
cvmod.1=cv.glmnet(y=y,x=as.matrix(X),alpha=1)
CV.0.ERROR=cvmod.0$cvm[which(cvmod.0$lambda==cvmod.0$lambda.1se)]
CV.25.ERROR=cvmod.25$cvm[which(cvmod.25$lambda==cvmod.25$lambda.1se)]
CV.5.ERROR=cvmod.5$cvm[which(cvmod.5$lambda==cvmod.5$lambda.1se)]
CV.75.ERROR=cvmod.75$cvm[which(cvmod.75$lambda==cvmod.75$lambda.1se)]
CV.1.ERROR=cvmod.1$cvm[which(cvmod.1$lambda==cvmod.1$lambda.1se)]
MOD.RESULT=tibble(alpha=c(0,0.25,0.5,0.75,1),
lambda=c(cvmod.0$lambda.1se,cvmod.25$lambda.1se,
cvmod.5$lambda.1se,cvmod.75$lambda.1se,
cvmod.1$lambda.1se),
CV.Error=c(CV.0.ERROR,CV.25.ERROR,CV.5.ERROR,
CV.75.ERROR,CV.1.ERROR))
print(MOD.RESULT)
best.alpha=MOD.RESULT$alpha[which.min(MOD.RESULT$CV.Error)]
best.lambda=MOD.RESULT$lambda[which.min(MOD.RESULT$CV.Error)]
best.mod=glmnet(y=y,x=as.matrix(X),nlambda=1,lambda=best.lambda,alpha=best.alpha)
best.coef=as.tibble(as.matrix(coef(best.mod)))
best.coef2=best.coef %>%
mutate(Parameter=c("Int",var.names)) %>%
rename(Estimate=s0) %>%
select(Parameter,Estimate)
nonzero.best.coef=best.coef2 %>%
filter(Estimate!=0)
print(nonzero.best.coef,n=1e3)
DATA2$hwy.hat=predict(best.mod,newx=as.matrix(X))
ggplot(DATA2) +
geom_point(aes(x=hwy,y=hwy.hat),color="lightskyblue2") +
geom_abline(a=0,b=1,linetype="dashed") +
theme_minimal() +
ylab("Predicted Highway MPG") +
xlab("Actual Highway MPG")
ggplot(DATA2) +
geom_histogram(aes(x=hwy-hwy.hat),fill="lightskyblue2") +
theme_minimal() +
xlab("Residuals") +
ylab("Frequency")
best.alpha=MOD.RESULT$alpha[which.min(MOD.RESULT$CV.Error)]
best.lambda=MOD.RESULT$lambda[which.min(MOD.RESULT$CV.Error)]
best.mod=glmnet(y=y,x=as.matrix(X),nlambda=1,lambda=best.lambda,alpha=best.alpha)
best.coef=as.tibble(as.matrix(coef(best.mod)))
best.coef2=best.coef %>%
mutate(Parameter=c("Int",var.names)) %>%
rename(Estimate=s0) %>%
select(Parameter,Estimate)
nonzero.best.coef=best.coef2 %>%
filter(Estimate!=0)
print(nonzero.best.coef,n=1e3)
DATA2$hwy.hat=predict(best.mod,newx=as.matrix(X))
ggplot(DATA2) +
geom_point(aes(x=hwy,y=hwy.hat),color="lightskyblue2") +
geom_abline(a=0,b=1,linetype="dashed") +
theme_minimal() +
ylab("Predicted Highway MPG") +
xlab("Actual Highway MPG")
ggplot(DATA2) +
geom_histogram(aes(x=hwy-hwy.hat),fill="lightskyblue2") +
theme_minimal() +
xlab("Residuals") +
ylab("Frequency")
best.alpha=MOD.RESULT$alpha[which.min(MOD.RESULT$CV.Error)]
best.lambda=MOD.RESULT$lambda[which.min(MOD.RESULT$CV.Error)]
best.mod=glmnet(y=y,x=as.matrix(X),nlambda=1,lambda=best.lambda,alpha=best.alpha)
best.coef=as.tibble(as.matrix(coef(best.mod)))
best.coef2=best.coef %>%
mutate(Parameter=c("Int",var.names)) %>%
rename(Estimate=s0) %>%
select(Parameter,Estimate)
nonzero.best.coef=best.coef2 %>%
filter(Estimate!=0)
print(nonzero.best.coef,n=1e3)
DATA2$hwy.hat=predict(best.mod,newx=as.matrix(X))
ggplot(DATA2) +
geom_point(aes(x=hwy,y=hwy.hat),color="lightskyblue2") +
geom_abline(a=0,b=1,linetype="dashed") +
theme_minimal() +
ylab("Predicted Highway MPG") +
xlab("Actual Highway MPG")
ggplot(DATA2) +
geom_histogram(aes(x=hwy-hwy.hat),fill="lightskyblue2") +
theme_minimal() +
xlab("Residuals") +
ylab("Frequency")
best.alpha=MOD.RESULT$alpha[which.min(MOD.RESULT$CV.Error)]
best.lambda=MOD.RESULT$lambda[which.min(MOD.RESULT$CV.Error)]
best.mod=glmnet(y=y,x=as.matrix(X),nlambda=1,lambda=best.lambda,alpha=best.alpha)
best.coef=as.tibble(as.matrix(coef(best.mod)))
best.coef2=best.coef %>%
mutate(Parameter=c("Int",var.names)) %>%
rename(Estimate=s0) %>%
select(Parameter,Estimate)
nonzero.best.coef=best.coef2 %>%
filter(Estimate!=0)
print(nonzero.best.coef,n=1e3)
DATA2$hwy.hat=predict(best.mod,newx=as.matrix(X))
ggplot(DATA2) +
geom_point(aes(x=hwy,y=hwy.hat),color="lightskyblue2") +
geom_abline(a=0,b=1,linetype="dashed") +
theme_minimal() +
ylab("Predicted Highway MPG") +
xlab("Actual Highway MPG")
ggplot(DATA2) +
geom_histogram(aes(x=hwy-hwy.hat),fill="lightskyblue2") +
theme_minimal() +
xlab("Residuals") +
ylab("Frequency")
best.coef
best.alpha=MOD.RESULT$alpha[which.min(MOD.RESULT$CV.Error)]
best.lambda=MOD.RESULT$lambda[which.min(MOD.RESULT$CV.Error)]
best.mod=glmnet(y=y,x=as.matrix(X),nlambda=1,lambda=best.lambda,alpha=best.alpha)
best.coef=as.tibble(as.matrix(coef(best.mod)))
best.coef2=best.coef %>%
mutate(Parameter=c("Int",var.names)) %>%
rename(Estimate=s0) %>%
select(Parameter,Estimate)
nonzero.best.coef=best.coef2 %>%
filter(Estimate!=0)
print(nonzero.best.coef,n=1e3)
DATA2$hwy.hat=predict(best.mod,newx=as.matrix(X))
ggplot(DATA2) +
geom_point(aes(x=hwy,y=hwy.hat),color="lightskyblue2") +
geom_abline(a=0,b=1,linetype="dashed") +
theme_minimal() +
ylab("Predicted Highway MPG") +
xlab("Actual Highway MPG")
ggplot(DATA2) +
geom_histogram(aes(x=hwy-hwy.hat),fill="lightskyblue2") +
theme_minimal() +
xlab("Residuals") +
ylab("Frequency")
library(Ecdat)
Part=Participation
dim(Part)
head(Part)
Part$lfp=ifelse(Part$lfp=="yes",1,0)
Part$foreign=ifelse(Part$foreign=="yes",1,0)
set.seed(216)
cvmod.0=cv.glmnet(y=as.factor(Part$lfp),x=as.matrix(Part[,-1]),alpha=0,
family="binomial",type.measure="class")
set.seed(216)
cvmod.25=cv.glmnet(y=as.factor(Part$lfp),x=as.matrix(Part[,-1]),alpha=0.25,
family="binomial",type.measure="class")
set.seed(216)
cvmod.5=cv.glmnet(y=as.factor(Part$lfp),x=as.matrix(Part[,-1]),alpha=0.5,
family="binomial",type.measure="class")
set.seed(216)
cvmod.75=cv.glmnet(y=as.factor(Part$lfp),x=as.matrix(Part[,-1]),alpha=0.75,
family="binomial",type.measure="class")
set.seed(216)
cvmod.1=cv.glmnet(y=as.factor(Part$lfp),x=as.matrix(Part[,-1]),alpha=1,
family="binomial",type.measure="class")
CV.0.ERROR=cvmod.0$cvm[which(cvmod.0$lambda==cvmod.0$lambda.1se)]
CV.25.ERROR=cvmod.25$cvm[which(cvmod.25$lambda==cvmod.25$lambda.1se)]
CV.5.ERROR=cvmod.5$cvm[which(cvmod.5$lambda==cvmod.5$lambda.1se)]
CV.75.ERROR=cvmod.75$cvm[which(cvmod.75$lambda==cvmod.75$lambda.1se)]
CV.1.ERROR=cvmod.1$cvm[which(cvmod.1$lambda==cvmod.1$lambda.1se)]
MOD.RESULT=tibble(alpha=c(0,0.25,0.5,0.75,1),
lambda=c(cvmod.0$lambda.1se,cvmod.25$lambda.1se,
cvmod.5$lambda.1se,cvmod.75$lambda.1se,
cvmod.1$lambda.1se),
CV.Error=c(CV.0.ERROR,CV.25.ERROR,CV.5.ERROR,
CV.75.ERROR,CV.1.ERROR))
print(MOD.RESULT)
best.alpha=MOD.RESULT$alpha[which.min(MOD.RESULT$CV.Error)]
best.lambda=MOD.RESULT$lambda[which.min(MOD.RESULT$CV.Error)]
best.mod=glmnet(y=as.factor(Part$lfp),x=as.matrix(Part[,-1]),
nlambda=1,lambda=best.lambda,alpha=best.alpha,
family="binomial")
best.coef=as.matrix(coef(best.mod))
head(best.coef)
Part$Predict=predict(best.mod,newx=as.matrix(Part[,-1]),type="class")
Part$lfp=ifelse(Part$lfp==1,"Yes","No")
Part$Predict=ifelse(Part$Predict=="1","Yes","No")
table(Part[,c("lfp","Predict")])
#Write Code that Counts the Number of Married Women Participating in the Workforce
#Write Code that Counts the Predicted Number of Married Women Participating in the Workforce
setwd("D:/Mario Documents/UNC/STOR 538/STOR538_WEBSITE/Slides/Sports Analytics 1")
library(tidyverse)
library(forcats)
DATA=read.csv("Sports Analytics Survey.csv")
names(DATA)=c("Country","State","Race","Watch","Participated","Other")
DATA
DATA2=separate(data=DATA,col=Watch,into=paste("Watch",1:23),sep=";")
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:21),sep=";")
DATA
View(DATA)
DATA
View(DATA)
DATA=read.csv("Sports Analytics Survey.csv")
DATA=read.csv("Sports Analytics Survey.csv")[,-1]
DATA=read.csv("Sports Analytics Survey.csv")[,-(1:3)]
DATA=read.csv("Sports Analytics Survey.csv")[,-(1:4)]
names(DATA)=c("Year","MajorMinor","Place","R Experience","Graduation","Watch","Particpated","Other")
DATA2=separate(data=DATA,col=Watch,into=paste("Watch",1:23),sep=";")
DATA2=separate(data=DATA,col=Watch,into=paste("Watch",1:47),sep=";")
setwd("D:/Mario Documents/UNC/STOR 538/STOR538_WEBSITE/Slides/Sports Analytics 1")
library(tidyverse)
library(forcats)
DATA=read.csv("Sports Analytics Survey.csv")[,-(1:4)]
names(DATA)=c("Year","MajorMinor","Place","R Experience","Graduation","Watch","Particpated","Other")
DATA2=separate(data=DATA,col=Watch,into=paste("Watch",1:47),sep=";")
View(DATA)
setwd("D:/Mario Documents/UNC/STOR 538/STOR538_WEBSITE/Slides/Sports Analytics 1")
library(tidyverse)
library(forcats)
DATA=read.csv("Sports Analytics Survey.csv")[,-(1:4)]
names(DATA)=c("Year","MajorMinor","Place","R Experience","Graduation","Watch","Participated","Other")
DATA2=separate(data=DATA,col=Watch,into=paste("Watch",1:47),sep=";")
View(DATA2)
DATA2=separate(data=DATA,col=Watch,into=paste("Watch",1:24),sep=";")
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:21),sep=";")
View(DATA3)
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:22),sep=";")
View(DATA3)
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:25),sep=";")
View(DATA3)
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:25),sep=";")
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:40),sep=";")
View(DATA3)
DATA3=separate(data=DATA2,col=Participated,into=paste("Part",1:25),sep=";")
View(DATA3)
table(DATA3$Year)
table(DATA3$MajorMinor)
table(DATA3$Place)
View(DATA3)
plot(table(DATA3$Place))
barplot(table(DATA3$Place))
unique(sportswatched)[4]
barplot(table(DATA3$`R Experience`),las=2,ylim=c(0,30),main="R Experience")
png('RExp.png',width=1200,height=800)
par(mar=c(14,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(DATA3$`R Experience`),las=2,ylim=c(0,30),main="R Experience")
dev.off()
png('RExp.png',width=1200,height=800)
par(mar=c(1,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(DATA3$`R Experience`),las=2,ylim=c(0,30),main="R Experience")
dev.off()
png('RExp.png',width=1200,height=800)
par(mar=c(3,2,3,2),cex=1.5,cex.main=2.5)
barplot(table(DATA3$`R Experience`),las=2,ylim=c(0,30),main="R Experience")
dev.off()
par(mar=c(3,2,3,2),cex=1.5,cex.main=2.5)
barplot(table(DATA3$`R Experience`),las=2,ylim=c(0,30),main="R Experience")
barplot(table(DATA3$`R Experience`),ylim=c(1,5),main="R Experience")
barplot(table(DATA3$`R Experience`),ylim=c(1,5),main="R Experience")
png('RExp.png',width=1200,height=800)
par(mar=c(3,2,3,2),cex=1.5,cex.main=2.5)
barplot(table(DATA3$`R Experience`),ylim=c(1,5),main="R Experience")
dev.off()
par(mar=c(3,4,3,2),cex.main=2.5)
barplot(table(DATA3$`R Experience`),ylim=c(1,5),main="R Experience")
barplot(table(DATA3$`R Experience`),ylim=c(0,20),main="R Experience")
table(DATA3$`R Experience`)
png('RExp.png',width=1200,height=800)
par(mar=c(3,4,3,2),cex.main=2.5)
barplot(table(DATA3$`R Experience`),ylim=c(0,20),main="R Experience")
dev.off()
png('RExp.png',width=1200,height=800)
par(mar=c(3,4,3,2),cex=1.5.cex.main=2.5)
barplot(table(DATA3$`R Experience`),ylim=c(0,20),main="R Experience")
dev.off()
par(mar=c(3,4,3,2),cex=1.5.cex.main=2.5)
barplot(table(DATA3$`R Experience`),ylim=c(0,20),main="R Experience")
png('RExp.png',width=1200,height=800)
par(mar=c(3,4,3,2),cex=2.cex.main=4)
barplot(table(DATA3$`R Experience`),ylim=c(0,20),main="R Experience")
dev.off()
png('RExp.png',width=1200,height=800)
par(mar=c(3,4,3,2),cex=1.5,cex.main=2.5)
barplot(table(DATA3$`R Experience`),ylim=c(0,20),main="R Experience")
dev.off()
par(mar=c(3,4,3,2),cex=1.5,cex.main=2.5)
barplot(table(DATA3$`Graduation`),ylim=c(0,20),main="Graduation Goal")
barplot(table(DATA3$`Graduation`),ylim=c(0,30),main="Graduation Goal")
barplot(table(DATA3$`Graduation`),las=2,ylim=c(0,30),main="Graduation Goal")
par(mar=c(14,4,3,2),cex=1.5,cex.main=2.5)
barplot(table(DATA3$`Graduation`),las=2,ylim=c(0,30),main="Graduation Goal")
png('Graduation.png',width=1200,height=800)
par(mar=c(14,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(DATA3$`Graduation`),las=2,ylim=c(0,30),main="Graduation Goal")
dev.off()
DATA4=DATA3 %>% mutate(Graduation=as.factor(Graduation))
View(DATA4)
levels(DATA4$Graduation)=c("Doctoral Degree","Masters Degree","one","two")
DATA4$Graduation
DATA3$Graduation
levels(DATA4$Graduation)
levels(DATA3$Graduation)
DATA4=DATA3 %>% mutate(Graduation=as.factor(Graduation))
levels(DATA4$Graduation)
levels(DATA4$Graduation)=c("Job Outside Sports Analytics","Job Inside Sports Analytics","Master's","Doctoral","Professional")
par(mar=c(14,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(DATA4$`Graduation`),las=2,ylim=c(0,30),main="Graduation Goal")
png('Graduation.png',width=1200,height=800)
par(mar=c(14,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(DATA4$`Graduation`),las=2,ylim=c(0,30),main="Graduation Goal")
dev.off()
png('Graduation.png',width=1200,height=800)
par(mar=c(10,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(DATA4$`Graduation`),las=2,ylim=c(0,30),main="Graduation Goal")
dev.off()
DATA4=DATA3 %>% mutate(Graduation=as.factor(Graduation))
levels(DATA4$Graduation)=c("Job Outside Sports Analytics","Job In Sports Analytics","Master's","Doctoral","Professional")
png('Graduation.png',width=1200,height=800)
par(mar=c(10,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(DATA4$`Graduation`),las=2,ylim=c(0,30),main="Graduation Goal")
dev.off()
levels(DATA4$Graduation)
png('Graduation.png',width=1200,height=800)
par(mar=c(10,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(DATA4$`Graduation`),las=2,ylim=c(0,30),main="Graduation Goal")
dev.off()
png('Graduation.png',width=1200,height=800)
par(mar=c(10,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(DATA4$`Graduation`),las=2,ylim=c(0,30),main="Graduation Goal")
dev.off()
png('Graduation.png',width=1200,height=800)
par(mar=c(12,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(DATA4$`Graduation`),las=2,ylim=c(0,30),main="Graduation Goal")
dev.off()
View(DATA4)
names(DATA4)[6:30]
sportswatched =  na.omit(gather(data=DATA4,6:29,key="Watch",value="Sport")$Sport)
sportswatched
unique(sportswatched)[4]
unique(sportswatched)
sportswatched2 = ifelse(sportswatched==unique(sportswatched)[11],"Arcade",sportswatched)
unique(sportswatched)
sportswatched7 = ifelse(sportswatched6==unique(sportswatched5)[9],"Air Sports",sportswatched4)
sportswatched6 = ifelse(sportswatched5==unique(sportswatched5)[22],"Board Games",sportswatched4)
sportswatched7 = ifelse(sportswatched6==unique(sportswatched5)[9],"Air Sports",sportswatched4)
sportswatched6 = ifelse(sportswatched5==unique(sportswatched5)[22],"Board Games",sportswatched4)
sportswatched6 = ifelse(sportswatched5==unique(sportswatched5)[22],"Board Games",sportswatched4)
sportswatched7 = ifelse(sportswatched6==unique(sportswatched6)[9],"Air Sports",sportswatched4)
sportswatched =  na.omit(gather(data=DATA4,6:29,key="Watch",value="Sport")$Sport)
sportswatched2 = ifelse(sportswatched==unique(sportswatched)[11],"Arcade",sportswatched)
sportswatched3 = ifelse(sportswatched2==unique(sportswatched2)[12],"Combat Sports",sportswatched2)
sportswatched4 = ifelse(sportswatched3==unique(sportswatched3)[8],"Auto/Bike Racing",sportswatched3)
sportswatched5 = ifelse(sportswatched4==unique(sportswatched4)[48],"Yard Games",sportswatched4)
sportswatched6 = ifelse(sportswatched5==unique(sportswatched5)[22],"Board Games",sportswatched4)
sportswatched7 = ifelse(sportswatched6==unique(sportswatched6)[9],"Air Sports",sportswatched4)
sportswatched7
sportswatched =  na.omit(gather(data=DATA4,6:29,key="Watch",value="Sport")$Sport)
sportswatched2 = ifelse(sportswatched==unique(sportswatched)[11],"Arcade",sportswatched)
sportswatched3 = ifelse(sportswatched2==unique(sportswatched)[12],"Combat Sports",sportswatched2)
sportswatched4 = ifelse(sportswatched3==unique(sportswatched)[8],"Auto/Bike Racing",sportswatched3)
sportswatched5 = ifelse(sportswatched4==unique(sportswatched)[48],"Yard Games",sportswatched4)
sportswatched6 = ifelse(sportswatched5==unique(sportswatched)[22],"Board Games",sportswatched4)
sportswatched7 = ifelse(sportswatched6==unique(sportswatched)[9],"Air Sports",sportswatched4)
sportswatched7
unique(sportswatched)[48]
sportswatched =  na.omit(gather(data=DATA4,6:29,key="Watch",value="Sport")$Sport)
sportswatched2 = ifelse(sportswatched==unique(sportswatched)[11],"Arcade",sportswatched)
sportswatched3 = ifelse(sportswatched2==unique(sportswatched)[12],"Combat Sports",sportswatched2)
sportswatched4 = ifelse(sportswatched3==unique(sportswatched)[8],"Auto/Bike Racing",sportswatched3)
sportswatched5 = ifelse(sportswatched4==unique(sportswatched)[48],"Yard Games",sportswatched4)
sportswatched6 = ifelse(sportswatched5==unique(sportswatched)[22],"Board Games",sportswatched5)
sportswatched7 = ifelse(sportswatched6==unique(sportswatched)[9],"Air Sports",sportswatched6)
sportswatched7
barplot(table(sportswatched7),las=2,ylim=c(0,30),main="Sports Watched")
png('Watched.png',width=1200,height=800)
par(mar=c(14,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(sportswatched7),las=2,ylim=c(0,30),main="Sports Watched")
dev.off()
barplot(table(sportswatched7),las=2,ylim=c(0,40),main="Sports Watched")
png('Watched.png',width=1200,height=800)
par(mar=c(14,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(sportswatched7),las=2,ylim=c(0,40),main="Sports Watched")
dev.off()
png('Watched.png',width=1200,height=800)
par(mar=c(14,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(sportswatched7),las=2,ylim=c(0,42),main="Sports Watched")
dev.off()
fct_reorder(as.factor(sportswatched7),fun=count)
barplot(table(fct_reorder(as.factor(sportswatched7),as.factor(sportswatched7),fun=count)),las=2,ylim=c(0,42),main="Sports Watched")
as.factor(sportswatched7)
fct_reorder(as.factor(sportswatched7))
fct_reorder(as.factor(sportswatched7),as.factor(sportswatched7))
count(sportswatched7)
count(sportswatched7)
count(as.factor(sportswatched7))
table(as.factor(sportswatched7))
fct_reorder(as.factor(sportswatched7),as.factor(sportswatched7),fun=table)
fct_reorder(as.factor(sportswatched7),as.factor(sportswatched7),.fun=table)
table(sportswatched7)
fct_reorder(as.factor(sportswatched7),sportswatched7,.fun=table)
levels(fct_reorder(as.factor(sportswatched7),sportswatched7,.fun=table))
png('Watched.png',width=1200,height=800)
par(mar=c(14,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportswatched7),sportswatched7,.fun=table)),las=2,ylim=c(0,42),main="Sports Watched")
dev.off()
sportsplayed =  na.omit(gather(data=DATA4,30:55,key="Watch",value="Sport")$Sport)
sportsplayed
sportsplayed =  na.omit(gather(data=DATA4,30:55,key="Part",value="Sport")$Sport)
sportsplayed
sportsplayed =  na.omit(gather(data=DATA4,30:55,key="Part",value="Sport")$Sport)
unique(sportsplayed)
sportsplayed =  na.omit(gather(data=DATA4,30:54,key="Part",value="Sport")$Sport)
sportsplayed
unique(sportsplayed)
sportsplayed =  na.omit(gather(data=DATA4,30:54,key="Part",value="Sport")$Sport)
sportsplayed
unique(sportsplayed)
sportsplayed =  na.omit(gather(data=DATA4,30:54,key="Part",value="Sport")$Sport)
sportsplayed2 = ifelse(sportsplayed==unique(sportsplayed)[7],"Arcade",sportsplayed)
sportsplayed3 = ifelse(sportsplayed2==unique(sportsplayed)[31],"Competitive Board Games",sportsplayed2)
sportsplayed4 = ifelse(sportsplayed3==unique(sportsplayed)[10],"Combat Sports",sportsplayed3)
sportsplayed5 = ifelse(sportsplayed4==unique(sportsplayed)[34],"Yard Games",sportsplayed4)
sportsplayed =  na.omit(gather(data=DATA4,30:54,key="Play",value="Sport")$Sport)
unique(sportsplayed)
View(DATA4)
unique(sportsplayed)
sportsplayed =  na.omit(gather(data=DATA4,30:54,key="Play",value="Sport")$Sport)
sportsplayed2 = ifelse(sportsplayed==unique(sportsplayed)[7],"Arcade",sportsplayed)
sportsplayed =  na.omit(gather(data=DATA4,30:54,key="Play",value="Sport")$Sport)
sportsplayed2 = ifelse(sportsplayed==unique(sportsplayed)[7],"Arcade",sportsplayed)
sportsplayed3 = ifelse(sportsplayed2==unique(sportsplayed)[31],"Competitive Board Games",sportsplayed2)
sportsplayed4 = ifelse(sportsplayed3==unique(sportsplayed)[10],"Combat Sports",sportsplayed3)
sportsplayed5 = ifelse(sportsplayed4==unique(sportsplayed)[34],"Yard Games",sportsplayed4)
png('Played.png',width=1200,height=800)
par(mar=c(14,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportsplayed5),sportsplayed5,.fun=table)),las=2,ylim=c(0,42),main="Sports Watched")
dev.off()
barplot(table(fct_reorder(as.factor(sportsplayed5),sportsplayed5,.fun=table)),las=2,ylim=c(0,35),main="Sports Watched")
png('Played.png',width=1200,height=800)
par(mar=c(14,2,3,1),cex=1.5,cex.main=2.5)
barplot(table(fct_reorder(as.factor(sportsplayed5),sportsplayed5,.fun=table)),las=2,ylim=c(0,35),main="Sports Watched")
dev.off()
check=intersect(unique(sportswatched7),unique(sportsplayed5))
sportswatched8=na.omit(ifelse(sportswatched7 %in% check,sportswatched7,NA))
sportsplayed6=na.omit(ifelse(sportsplayed5 %in% check,sportsplayed5,NA))
par(mar=c(12,2.2,1,1),cex=2)
barplot(table(sportswatched6),las=2,ylim=c(-30,30),col="red")
barplot(-table(sportsplayed6),las=2,ylim=c(-30,30),add=T,col="blue")
png('Together.png',width=1400,height=700)
par(mar=c(12,2.2,1,1),cex=2)
barplot(table(sportswatched6),las=2,ylim=c(-30,30),col="red")
barplot(-table(sportsplayed6),las=2,ylim=c(-30,30),add=T,col="blue")
dev.off()
png('Together.png',width=1400,height=700)
par(mar=c(12,2.2,1,1),cex=2)
barplot(table(sportswatched8),las=2,ylim=c(-30,30),col="red")
barplot(-table(sportsplayed6),las=2,ylim=c(-30,30),add=T,col="blue")
dev.off()
-table(sportsplayed6)
png('Together.png',width=1400,height=700)
par(mar=c(12,2.2,1,1),cex=2)
barplot(table(sportswatched8),las=2,ylim=c(-35,35),col="red")
barplot(-table(sportsplayed6),las=2,ylim=c(-35,35),add=T,col="blue")
dev.off()
png('Together.png',width=1400,height=700)
par(mar=c(12,2.2,1,1),cex=2)
barplot(table(sportswatched8),las=2,ylim=c(-40,40),col="red")
barplot(-table(sportsplayed6),las=2,ylim=c(-40,40),add=T,col="blue")
dev.off()
